<?xml version="1.0" encoding="UTF-8" ?>
<Module>
    <ModulePrefs 
        title="Twigga"
        description="Simple twitter stats gatherer for Google docs"/>
    <UserPref
        name="product_name"
        display_name="Product name"
        required="true"/>
    <Content type="html">
        <![CDATA[
        <script
            src="http://www.google.com/jsapi"
            type="text/javascript" type="text/javascript"></script>

        <div id="content_div" style="font-size:20pt; padding:5px; text-align: center;"/>

        <script type="text/javascript">
            _IG_RegisterOnloadHandler(loadJQuery);

            function loadJQuery() {
                google.load("jquery", "1.4.1");
                google.setOnLoadCallback(sendQuery);
            }

            function sendQuery() {
                var prefs = new gadgets.Prefs();
                var jssrc = "http://jquery-twitter-api.googlecode.com/svn/trunk/jquery-twitter-plugin.js";
                var head = document.getElementsByTagName('head')[0];
                var scripts = document.getElementsByTagName('script');
                var isPresent = false;
                for (var i; i < scripts.length; ++i) {
                    if(scripts[i].src.toLowerCase() == jssrc.toLowerCase()) {
                        isPresent = true;
                        break;
                    }
                }
                if (!isPresent) {
                    var newjs = document.createElement('script');
                    newjs.type = 'text/javascript';
                    newjs.source = jssrc;
                    head.appendChild(newjs);
                }
                
                var content_div = document.getElementById('content_div');
                content_div.innerHTML = "Hello, " + prefs.getString("product_name") + "!";
                content_div.style.width = document.body.clientWidth + 'px';
                content_div.style.height = document.body.clientHeight + 'px';
            }
        </script>
        ]]>
    </Content>
</Module>
