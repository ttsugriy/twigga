<?xml version="1.0" encoding="UTF-8" ?>
<Module>
    <ModulePrefs 
        title="Twigga"
        description="Simple twitter stats gatherer for Google docs"/>
    <UserPref
        name="product_name"
        display_name="Product name"
        required="true"/>
    <Content type="html">
        <![CDATA[
        <script
            src="http://www.google.com/jsapi"
            type="text/javascript" type="text/javascript"></script>

        <div id="table_div" style="overflow: auto;">
            <img src="http://www.google.com/ig/images/spinner.gif" />
        </div>

        <script type="text/javascript">
            _IG_RegisterOnloadHandler(loadJQuery);

            function loadJQuery() {
                google.load("jquery", "1.4.1");
                google.setOnLoadCallback(sendQuery);
            }

            function sendQuery() {
                var prefs = new gadgets.Prefs();
                var table_div = document.getElementById('content_div');
                table_div.innerHTML = "Trends for " + prefs.getString("product_name") + "!";
                table_div.style.width = document.body.clientWidth + 'px';
                table_div.style.height = document.body.clientHeight + 'px';
                $.getJSON("http://search.twitter.com/trends.json?count=10&callback=?", function(data) {
                    table_div.innerHTML += "<table>";
                    for (var i = 0; i < data.trends.length; i++) {
                        table_div.innerHTML += "<tr><td>" + data.trends[i].name + "</td></tr>";
                    }
                    table_div.innerHTML += "</table>";
                });
            }

        </script>
        ]]>
    </Content>
</Module>
